<role oid="02fff242-b3d1-4905-bdaa-cb68f92a2ac6"
    xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
    xmlns:apti="http://midpoint.evolveum.com/xml/ns/public/common/api-types-3"
    xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
    xmlns:icfs="http://midpoint.evolveum.com/xml/ns/public/connector/icf-1/resource-schema-3"
    xmlns:org="http://midpoint.evolveum.com/xml/ns/public/common/org-3"
    xmlns:q="http://prism.evolveum.com/xml/ns/public/query-3"
    xmlns:ri="http://midpoint.evolveum.com/xml/ns/public/resource/instance-3"
    xmlns:t="http://prism.evolveum.com/xml/ns/public/types-3"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	version="7">
    <name>IAM Service API</name>
    <description>Allows service access to midPoint API</description>

    <authorization>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-rest-3#all</action>
    </authorization>
    
    <authorization>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
        <phase>request</phase>
        <object>
	        <type>UserType</type>
	    </object>
	    <object>
	        <type>RoleType</type>
	    </object>
    </authorization>
    
    <authorization>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#read</action>
        <phase>execution</phase>
        <object>
	        <type>UserType</type>
	    </object>
	    <object>
	        <type>RoleType</type>
	    </object>
    </authorization>
    
    <authorization>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <phase>request</phase>
        <object>
	        <type>UserType</type>
	    </object>
    </authorization>
    
    <authorization>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <phase>execution</phase>
        <object>
	        <type>UserType</type>
	    </object>
    </authorization>
    
    <authorization>
    	<action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#add</action>
    	<action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#modify</action>
        <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#delete</action>
        <phase>execution</phase>
        <object>
	        <type>ShadowType</type>
	    </object>
    </authorization>
    
    <!-- allow assignment of Base ONID role -->
    <authorization>
	    <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#assign</action>
	    <phase>request</phase>
	    <object>
	        <type>UserType</type>
	    </object>
	    <target>
	        <type>RoleType</type>
	        <!-- <filter>
	            <q:equal>
	                <q:path>name</q:path>
	                <q:value>Base ONID</q:value>
	            </q:equal>
	        </filter> -->
	    </target>
    </authorization>
    
    <!-- allow un-assignment of Base ONID role -->
    <authorization>
	    <action>http://midpoint.evolveum.com/xml/ns/public/security/authorization-model-3#unassign</action>
	    <phase>request</phase>
	    <object>
	        <type>UserType</type>
	    </object>
	    <target>
	        <type>RoleType</type>
	        <!-- <filter>
	            <q:equal>
	                <q:path>name</q:path>
	                <q:value>Base ONID</q:value>
	            </q:equal>
	        </filter> -->
	    </target>
    </authorization>
    
    
</role>